import { useState, useRef, useEffect } from "react"
import { useTranslation } from 'react-i18next'
import "../../../styles/roulette.css"

export default function Roulette({data, setContinue}){
    const [rotate, setRotate] = useState(0)
    const [display, setDisplay] = useState(true)
    const didMount = useRef(false)

  const { t } = useTranslation("roulette")

    useEffect(()=>{
        if ( !didMount.current ) {
            didMount.current = true;
            return;
        }
        setTimeout(() => {
            if(setContinue){
                setContinue(true)
            }
        }, (data.time * 1000) + 100 )
    },[rotate])


    const handleClick = () => {
        setRotate(720 + [75, 150, 212, 295, 360][Math.floor(Math.random() * 5)])
        setDisplay(false)
    }

    return (
        <div className="roulette">
            <svg width="480" height="480" viewBox="0 0 480 480" fill="none" xmlns="http://www.w3.org/2000/svg">
            <g id="Ruleta">
            <g id="RuletaNumbers">
            <g id="Ruleta_2" style={{transform: `rotate(${rotate}deg)`, transition:`${data.time}s ease-out`, transformOrigin:"center center"}}>
            <path id="Vector" fillRule="evenodd" clipRule="evenodd" d="M368.499 69.1874C462.72 140.144 481.608 274.248 410.651 368.47C339.694 462.691 205.591 481.578 111.369 410.622C17.148 339.665 -1.7396 205.562 69.2171 111.339C140.174 17.1185 274.277 -1.76907 368.499 69.1877L368.499 69.1874Z" fill="#004844"/>
            <path id="Vector_2" fillRule="evenodd" clipRule="evenodd" d="M236.556 244.388L112.943 67.9617C187.031 13.2334 291.189 10.9684 368.497 69.1885L236.556 244.388Z" fill="#008E86"/>
            <path id="Vector_3" fillRule="evenodd" clipRule="evenodd" d="M232.497 247.22C233.406 248.517 234.881 249.301 236.465 249.328C238.049 249.355 239.55 248.623 240.503 247.358L372.444 72.1578C374.088 69.9747 373.651 66.8721 371.468 65.228C292.369 5.6599 185.8 7.97839 109.997 63.9739C107.837 65.5688 107.344 68.5949 108.884 70.7937L232.498 247.22H232.497ZM236.694 235.963C217.781 208.97 136.008 92.2587 119.791 69.113C190.599 19.3162 287.812 17.3357 361.525 70.203L236.693 235.963H236.694Z" fill="#004844"/>
            <path id="Vector_4" fillRule="evenodd" clipRule="evenodd" d="M233 453.45C190.466 452.117 147.917 438.111 111.368 410.587C74.839 383.077 49.6328 346.075 36.5959 305.585L236.557 244.354L233 453.45Z" fill="#008E86"/>
            <path id="Vector_5" fillRule="evenodd" clipRule="evenodd" d="M232.839 458.39C234.163 458.431 235.448 457.94 236.408 457.026C237.367 456.113 237.919 454.853 237.942 453.528L241.498 244.431C241.525 242.848 240.792 241.347 239.526 240.394C238.261 239.441 236.616 239.152 235.101 239.616L35.1406 300.848C33.8739 301.235 32.8157 302.115 32.2027 303.289C31.5899 304.464 31.4733 305.835 31.8792 307.096C45.2186 348.525 71.0082 386.385 108.385 414.534C145.781 442.696 189.318 457.025 232.839 458.39ZM228.133 448.28C188.265 446.072 148.603 432.431 114.339 406.628C80.0936 380.838 56.0353 346.509 42.8959 308.823C42.8961 308.823 231.487 251.073 231.487 251.073L228.133 448.28Z" fill="#004844"/>
            <path id="Vector_6" fillRule="evenodd" clipRule="evenodd" d="M368.499 69.1207C445.807 127.341 472.4 228.072 440.264 314.394L236.558 244.321L368.499 69.1207Z" fill="#008E86"/>
            <path id="Vector_7" fillRule="evenodd" clipRule="evenodd" d="M371.469 65.2585L371.463 65.2531L368.492 74.1591L365.529 73.1707C364.921 72.7185 364.415 72.1232 364.064 71.4192C363.227 69.7404 363.411 67.7323 364.54 66.2338L232.599 241.434C231.646 242.699 231.356 244.344 231.82 245.859C232.283 247.373 233.444 248.575 234.942 249.09L438.648 319.164C441.187 320.037 443.959 318.727 444.895 316.211C477.775 227.89 450.568 124.826 371.469 65.258L371.469 65.2587V65.2585ZM369.432 76.1885C440.608 132.443 465.551 226.415 437.251 308.217L244.602 241.947L369.432 76.1885Z" fill="#004844"/>
            <path id="Vector_8" fillRule="evenodd" clipRule="evenodd" d="M440.254 314.502C433.223 333.389 423.381 351.587 410.644 368.499C367.197 426.191 300.076 455.639 232.932 453.513L236.55 244.474L440.254 314.502Z" fill="#008E86"/>
            <path id="Vector_9" fillRule="evenodd" clipRule="evenodd" d="M444.885 316.223C445.35 314.972 445.291 313.587 444.721 312.381C444.151 311.175 443.118 310.25 441.856 309.816L238.153 239.788C236.655 239.273 235.002 239.506 233.705 240.415C232.408 241.324 231.624 242.799 231.597 244.382L227.979 453.42C227.932 456.125 230.066 458.366 232.77 458.452C301.467 460.628 370.139 430.496 414.591 371.47C427.622 354.166 437.691 335.546 444.885 316.223ZM433.78 317.506C427.07 334.261 418.059 350.413 406.685 365.516C365.295 420.476 301.91 449.195 237.959 448.658L241.374 251.361L433.78 317.506Z" fill="#004844"/>
            <path id="Vector_10" fillRule="evenodd" clipRule="evenodd" d="M236.695 244.449L36.5969 305.578C16.007 241.633 25.7702 168.989 69.217 111.297C81.9607 94.3753 96.7415 79.8832 112.953 67.9121L236.695 244.449Z" fill="#008E86"/>
            <path id="Vector_11" fillRule="evenodd" clipRule="evenodd" d="M238.135 249.175C239.651 248.713 240.853 247.552 241.369 246.053C241.884 244.555 241.651 242.9 240.742 241.603L116.999 65.0654C116.234 63.9734 115.06 63.2364 113.744 63.0217C112.427 62.8072 111.08 63.1328 110.007 63.925C93.4207 76.1732 78.2973 91.0003 65.2583 108.314C20.8063 167.34 10.8146 241.664 31.8807 307.088C32.7094 309.662 35.4507 311.094 38.0367 310.304L238.135 249.175ZM228.725 241.702C228.725 241.702 69.4941 290.346 39.8613 299.399C21.6802 238.083 31.7734 169.229 73.1641 114.268C84.5449 99.1557 97.5879 86.027 111.842 74.9505L228.725 241.702Z" fill="#004844"/>
            <path id="Vector_12" d="M100.947 183.615L161.133 203.621L156.503 217.55L107.495 201.259L103.493 213.296L92.3162 209.581L100.947 183.615Z" fill="white"/>
            <path id="Vector_13" d="M265.716 143.622L265.683 155.582L217.753 155.449L217.78 145.936L242.307 122.899C244.911 120.43 246.669 118.305 247.58 116.526C248.491 114.747 248.949 112.981 248.953 111.23C248.96 108.693 248.105 106.742 246.387 105.378C244.67 104.014 242.15 103.328 238.828 103.319C236.049 103.311 233.541 103.833 231.303 104.884C229.065 105.934 227.188 107.515 225.672 109.625L215 102.709C217.487 99.0314 220.907 96.1566 225.262 94.0847C229.617 92.0127 234.603 90.9847 240.221 91.0002C244.932 91.0132 249.053 91.7949 252.582 93.345C256.111 94.8949 258.853 97.077 260.809 99.8912C262.764 102.705 263.736 106.015 263.726 109.821C263.716 113.264 262.983 116.493 261.525 119.509C260.067 122.526 257.248 125.961 253.07 129.815L238.444 143.547L265.716 143.622Z" fill="white"/>
            <path id="Vector_14" d="M356.817 219.143C357.641 224.713 356.962 229.398 354.781 233.199C352.6 237 349.237 239.625 344.69 241.073C341.179 242.192 337.648 242.302 334.098 241.405C330.547 240.507 327.279 238.458 324.294 235.256C321.309 232.055 318.946 227.72 317.204 222.253C315.847 217.994 315.074 213.628 314.886 209.155C314.698 204.682 315.181 200.677 316.336 197.14L328.774 199.169C327.78 202.021 327.29 205.109 327.303 208.433C327.316 211.757 327.827 215.002 328.835 218.167C329.953 221.678 331.51 224.225 333.504 225.809C335.498 227.392 337.733 227.79 340.207 227.002C345.157 225.425 346.431 220.867 344.029 213.327L341.994 206.939L351.232 203.996L369.264 211.945L361.069 186.218L372.291 182.643L385.767 224.946L376.702 227.833L356.817 219.143Z" fill="white"/>
            <path id="Vector_15" d="M159.9 340.01C152.714 334.691 148.47 329.333 147.168 323.935C145.866 318.537 146.993 313.435 150.551 308.628C152.851 305.521 155.721 303.268 159.162 301.869C162.602 300.47 166.478 300.183 170.79 301.008C175.102 301.833 179.589 303.97 184.249 307.42C187.842 310.079 191.024 313.167 193.794 316.683C196.565 320.2 198.517 323.73 199.651 327.275L188.305 332.855C187.441 329.961 186.044 327.179 184.112 324.509C182.181 321.839 179.88 319.516 177.209 317.539C174.248 315.347 171.486 314.205 168.924 314.112C166.363 314.02 164.309 315.017 162.764 317.105C161.147 319.29 160.811 321.596 161.756 324.025C162.702 326.453 165.359 329.284 169.729 332.519L182.764 342.168L158.904 368.92L127.808 345.902L134.815 336.435L156.08 352.175L164.051 343.083L159.9 340.01Z" fill="white"/>
            <path id="Vector_16" d="M266.795 340.152L275.186 334.128L267.418 323.309L279.047 314.96L286.815 325.78L314.563 305.859L320.322 313.881L319.495 363.998L306.983 372.98L307.259 325.825L293.422 335.759L300.344 345.401L289.083 353.486L282.161 343.844L273.771 349.868L266.795 340.152Z" fill="white"/>
            </g>
            </g>
            <g id="Ruleta_Marco">
            <g id="Marco" filter="url(#filter0_d)">
            <path id="Vector_17" fillRule="evenodd" clipRule="evenodd" d="M239.926 11.3538C113.782 11.3538 11.3684 113.767 11.3684 239.912C11.3684 366.056 113.782 468.469 239.926 468.469C366.071 468.469 468.484 366.056 468.484 239.912C468.484 113.767 366.071 11.3538 239.926 11.3538ZM239.926 41.0445C349.684 41.0445 438.793 130.154 438.793 239.912C438.793 349.669 349.684 438.778 239.926 438.778C130.169 438.778 41.0591 349.669 41.0591 239.912C41.0591 130.154 130.169 41.0445 239.926 41.0445Z" fill="#00D8CC"/>
            <path id="Vector_18" fillRule="evenodd" clipRule="evenodd" d="M254.505 7.50605C254.505 4.77308 252.289 2.55768 249.556 2.55768H230.297C227.565 2.55768 225.349 4.77308 225.349 7.50605V76.7407C225.349 77.5335 225.54 78.315 225.905 79.0188L235.56 97.6363C236.411 99.2785 238.108 100.309 239.958 100.307C241.808 100.305 243.502 99.2709 244.35 97.6268L253.954 79.0093C254.316 78.3079 254.505 77.53 254.505 76.7407V7.50605Z" fill="#F97D61"/>
            </g>
            </g>
            <g id="RuletaButton">
            <g id="Icon" filter="url(#filter1_d)">
            <path id="Vector_19" d="M239.924 293.322C269.431 293.322 293.352 269.402 293.352 239.894C293.352 210.387 269.431 186.466 239.924 186.466C210.416 186.466 186.496 210.387 186.496 239.894C186.496 269.402 210.416 293.322 239.924 293.322Z" fill="#004844"/>
            <path id="Vector_20" d="M239.923 282.837C263.665 282.837 282.912 263.59 282.912 239.848C282.912 216.106 263.665 196.859 239.923 196.859C216.181 196.859 196.934 216.106 196.934 239.848C196.934 263.59 216.181 282.837 239.923 282.837Z" fill="#008E86"/>
            <g id="Group">
            <path id="Vector_21" fillRule="evenodd" clipRule="evenodd" d="M229.672 221.638L215.759 205.803L214.956 213.535L215.759 223.283L219.051 229.452L229.672 221.638ZM250.185 221.638L264.098 205.803L264.902 213.535L264.098 223.283L260.807 229.452L250.185 221.638Z" fill="#E6C786"/>
            <path id="Vector_22" fillRule="evenodd" clipRule="evenodd" d="M239.926 217.404L247.766 218.598L255.619 223.533L260.804 229.503L264.096 238.749L239.926 244.595L215.757 238.749L219.049 229.503L224.234 223.533L232.087 218.598L239.926 217.404Z" fill="#E55636"/>
            <path id="Vector_23" fillRule="evenodd" clipRule="evenodd" d="M232.087 218.548L226.183 212.571L215.757 205.803L219.346 214.302L220.419 221.531L222.312 228.779L227.842 226.218L231.488 221.902L232.087 218.548ZM247.766 218.548L253.669 212.571L264.096 205.803L260.506 214.302L259.434 221.531L257.541 228.779L252.011 226.218L248.365 221.902L247.766 218.548Z" fill="#99250C"/>
            <path id="Vector_24" fillRule="evenodd" clipRule="evenodd" d="M226.939 254.828L215.532 251.755L199.699 251.27L208.263 243.001L215.76 238.708L229.003 241.549L234.808 238.04L239.929 236.499L245.051 238.04L250.856 241.549L264.099 238.708L271.596 243.001L280.16 251.27L264.326 251.755L252.92 254.828L239.929 260.112L226.939 254.828Z" fill="#E9D6B6"/>
            <path id="Vector_25" fillRule="evenodd" clipRule="evenodd" d="M234.581 262.693L231.301 258.679L225.255 255.506L212.522 252.328L199.699 251.279L212.228 249.792L226.883 251.898L235.621 256.674L239.929 257.375L244.237 256.674L252.976 251.898L267.631 249.792L280.16 251.279L267.337 252.328L254.603 255.506L248.558 258.679L245.278 262.693L239.929 264.234L234.581 262.693Z" fill="#E6C786"/>
            <path id="Vector_26" fillRule="evenodd" clipRule="evenodd" d="M239.934 242.541L243.883 242.613L246.862 243.952L248.28 246.222L246.899 249.34L243.599 249.822L239.934 248.886L236.268 249.822L232.969 249.34L231.588 246.222L233.006 243.952L235.984 242.613L239.934 242.541Z" fill="black"/>
            </g>
            </g>
            </g>
            </g>
            <defs>
            <filter id="filter0_d" x="11.3684" y="2.55768" width="457.115" height="473.911" filterUnits="userSpaceOnUse" colorInterpolationFilters="sRGB">
            <feFlood floodOpacity="0" result="BackgroundImageFix"/>
            <feColorMatrix in="SourceAlpha" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0" result="hardAlpha"/>
            <feOffset dy="8"/>
            <feColorMatrix type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.5 0"/>
            <feBlend mode="normal" in2="BackgroundImageFix" result="effect1_dropShadow"/>
            <feBlend mode="normal" in="SourceGraphic" in2="effect1_dropShadow" result="shape"/>
            </filter>
            <filter id="filter1_d" x="186.496" y="186.466" width="106.856" height="110.856" filterUnits="userSpaceOnUse" colorInterpolationFilters="sRGB">
            <feFlood floodOpacity="0" result="BackgroundImageFix"/>
            <feColorMatrix in="SourceAlpha" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0" result="hardAlpha"/>
            <feOffset dy="4"/>
            <feColorMatrix type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.25 0"/>
            <feBlend mode="normal" in2="BackgroundImageFix" result="effect1_dropShadow"/>
            <feBlend mode="normal" in="SourceGraphic" in2="effect1_dropShadow" result="shape"/>
            </filter>
            </defs>
            </svg>
            <span style={{display:`${display?"flex":"none"}`}} onClick={handleClick}>{t("button")}</span>
        </div>
    )

}
